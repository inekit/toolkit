# Конфигурация nginx для оптимизации локальных шрифтов Inter
# Включить в основную конфигурацию: include nginx-fonts.conf;

# MIME типы для современных форматов шрифтов
types {
    font/woff2 woff2;
    font/woff woff;
    application/font-woff2 woff2;
    application/font-woff woff;
    application/x-font-woff2 woff2;
    application/x-font-woff woff;
}

# Специальная локация для папки fonts
location /fonts/ {
    # Кеширование на 1 год для шрифтов
    expires 1y;
    add_header Cache-Control "public, immutable";
    
    # Безопасность
    add_header X-Content-Type-Options nosniff;
    add_header X-Frame-Options "SAMEORIGIN";
    
    # CORS для шрифтов (если нужно)
    add_header Access-Control-Allow-Origin "*";
    add_header Vary "Accept-Encoding";
    
    # Приоритетная обработка
    try_files $uri =404;
    
    # Отключаем сжатие для WOFF2 (уже сжаты)
    location ~* \.woff2$ {
        gzip off;
        add_header Content-Type "font/woff2";
    }
    
    # Сжатие для других форматов шрифтов
    location ~* \.(woff|ttf|eot|otf)$ {
        gzip on;
        gzip_comp_level 6;
        add_header Content-Type "font/woff";
    }
}

# Глобальные настройки для всех шрифтов
location ~* \.(woff2|woff|ttf|eot|otf)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
    add_header X-Content-Type-Options nosniff;
    add_header Access-Control-Allow-Origin "*";
    add_header Vary "Accept-Encoding";
    
    # Отключаем сжатие для WOFF2
    location ~* \.woff2$ {
        gzip off;
    }
    
    try_files $uri =404;
}

# Настройки сжатия для шрифтов
gzip_types
    text/plain
    text/css
    text/xml
    text/javascript
    application/json
    application/javascript
    application/xml+rss
    application/atom+xml
    image/svg+xml
    application/x-font-ttf
    font/opentype
    application/vnd.ms-fontobject
    font/woff
    font/woff2;
