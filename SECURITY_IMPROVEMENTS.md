# üîí –£–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ nginx –¥–ª—è counterplus.ru

## ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Ä—ã –∑–∞—â–∏—Ç—ã

### 1. üö´ Rate Limiting

- **API –∑–æ–Ω–∞**: 10 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
- **–ü–æ–∏—Å–∫–æ–≤—ã–µ —Ä–æ–±–æ—Ç—ã**: 100 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
- **–û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: 30 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
- **Burst —Ä–µ–∂–∏–º**: 20-50 –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

### 2. ü§ñ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –±–æ—Ç–æ–≤

- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**: masscan, nmap, sqlmap
- **–í–µ–±-—Å–∫—Ä–∞–ø–µ—Ä—ã**: python, curl, wget
- **–ü–µ–Ω—Ç–µ—Å—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**: nikto, w3af, dirb
- **–í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Å–∫–∞–Ω–µ—Ä—ã**: acunetix, netsparker

### 3. üõ°Ô∏è –£–ª—É—á—à–µ–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- **CSP**: –°—Ç—Ä–æ–≥–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **Referrer Policy**: –ö–æ–Ω—Ç—Ä–æ–ª—å —Ä–µ—Ñ–µ—Ä–µ—Ä–æ–≤
- **Permissions Policy**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ API
- **HSTS**: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π HTTPS

### 4. üîê –£–ª—É—á—à–µ–Ω–Ω—ã–µ SSL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- **TLS 1.2 + 1.3**: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã
- **OCSP Stapling**: –£—Å–∫–æ—Ä–µ–Ω–∏–µ SSL –ø—Ä–æ–≤–µ—Ä–æ–∫
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∏—Ñ—Ä—ã**: ChaCha20-Poly1305
- **–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –±–∏–ª–µ—Ç–æ–≤**: –ü–æ–≤—ã—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 5. üö® –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

- **Path Traversal**: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ `../` –≤ URL
- **–ú–µ—Ç–æ–¥—ã**: –¢–æ–ª—å–∫–æ GET, POST, HEAD
- **–§–∞–π–ª—ã**: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ .php, .asp, .exe
- **–ö–æ–Ω—Ñ–∏–≥–∏**: –ó–∞—â–∏—Ç–∞ .env, .config, .sql

### 6. ‚è±Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∞—Ç–∞–∫

- **–¢–∞–π–º–∞—É—Ç—ã**: 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–†–∞–∑–º–µ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 1k-8k
- **Body timeout**: –ó–∞—â–∏—Ç–∞ –æ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

### 7. üîç –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –¥–ª—è SEO

- **robots.txt**: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è –±–æ—Ç–æ–≤
- **sitemap.xml**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **X-Robots-Tag**: –Ø–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ä–æ–±–æ—Ç–æ–≤

## üéØ –ë–∞–ª–∞–Ω—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

### ‚úÖ –ß—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ:

- –í—Å–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ —Ä–æ–±–æ—Ç—ã (Google, Yandex, Bing)
- –õ–æ–∫–∞–ª—å–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
- SPA —Ä–æ—É—Ç–∏–Ω–≥ –∏ API –∑–∞–ø—Ä–æ—Å—ã
- –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å rate limiting

### ‚ùå –ß—Ç–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ:

- –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Å–∫–∞–Ω–µ—Ä—ã –∏ –±–æ—Ç—ã
- –ü–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ñ–∞–π–ª–∞–º
- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ HTTP –º–µ—Ç–æ–¥—ã
- Path traversal –∞—Ç–∞–∫–∏

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
nginx -t
```

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ nginx:

```bash
systemctl reload nginx
# –∏–ª–∏
systemctl restart nginx
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:

```bash
tail -f /var/log/nginx/access.log | grep -i "403\|444\|400"
tail -f /var/log/nginx/error.log
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:

- **403**: –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–æ—Ç—ã
- **444**: –ù–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ HTTP –º–µ—Ç–æ–¥—ã
- **400**: Path traversal –ø–æ–ø—ã—Ç–∫–∏
- **429**: Rate limit –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è

### –ú–µ—Ç—Ä–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º —Ñ–∞–π–ª–∞–º
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –±–æ—Ç–æ–≤
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å rate limiting

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ –≤–∞—à–∏ –Ω—É–∂–¥—ã

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ rate limits:

```nginx
limit_req_zone $binary_remote_addr zone=general:10m rate=50r/s;
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –±–æ—Ç–æ–≤:

```nginx
~* "–Ω–æ–≤—ã–π-–±–æ—Ç" 1;
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ CSP:

```nginx
add_header Content-Security-Policy "default-src 'self'; ...";
```

---

**‚ö†Ô∏è –í–∞–∂–Ω–æ**: –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Ä–æ–±–æ—Ç–æ–≤!
